{# Ultra-DRY Bootstrap carousel with Tailwind styling #}
<div id="{{ carousel_id }}" 
     class="carousel slide rounded-2xl overflow-hidden relative mb-4 p-2 md:p-4 border-4 border-white bg-gradient-to-br from-gray-900 to-gray-800"
     style="height: 60vh; min-height: 350px; max-height: 600px;"
     data-bs-ride="carousel" 
     data-bs-interval="{{ interval|default(20000) }}">
  
  <!-- Indicators with Tailwind styling -->
  <div class="carousel-indicators">
    {% for slide in slides %}
      <button type="button" 
              data-bs-target="#{{ carousel_id }}" 
              data-bs-slide-to="{{ loop.index0 }}"
              class="w-3 h-3 rounded-full bg-white/70 hover:bg-white transition-all duration-200{% if loop.first %} active bg-white{% endif %}"
              aria-current="{% if loop.first %}true{% else %}false{% endif %}"
              aria-label="Slide {{ loop.index }}"></button>
    {% endfor %}
  </div>

  <!-- Carousel content -->
  <div class="carousel-inner h-full">
    {% for slide in slides %}
      <div class="carousel-item h-full{% if loop.first %} active{% endif %}">
        <div class="flex w-full h-full">
          <!-- Image column - Left side -->
          <div class="w-1/2 flex items-center justify-center h-full p-4 bg-black border-r-2 border-white">
            {% set media_type = 'video' if slide.src.endswith('.mp4') else 'image' %}
            {% set media_src = slide.src %}
            {% set media_alt = slide.alt %}
            {% include 'components/common/media.html' %}
          </div>
          <!-- Text column - Right side -->
          <div class="w-1/2 flex flex-col justify-center p-4 h-full overflow-auto bg-black text-white">
            <div class="animate-fade-in w-full">
              {% if slide.title %}
                <h3 class="text-white mb-4 text-xl font-semibold">{{ slide.title }}</h3>
              {% endif %}
              <!-- Multi-paragraph content with sources -->
              {% if slide.highlight and slide.sources1 and slide.sources2 %}
                <p class="text-gray-100 mb-4">{{ slide.text }}</p>
                <div class="mb-4">
                  {% set sources = slide.sources1 %}
                  {% include 'components/common/sources.html' %}
                </div>
                <p class="text-yellow-300 mb-4 font-medium">{{ slide.highlight }}</p>
                <div class="mb-4">
                  {% set sources = slide.sources2 %}
                  {% include 'components/common/sources.html' %}
                </div>
              {% elif slide.sources1 %}
                <div class="text-white prose prose-invert">
                  {% set paragraphs = slide.text.split('\n\n') %}
                  {% for paragraph in paragraphs %}
                    {% set p = paragraph %}
                    {% if slide.team_links and 'Alan Smith' in p %}
                      {% set p = p.replace('Alan Smith', '<a href="' ~ slide.team_links['Alan Smith'] ~ '" target="_blank" class="text-blue-400 hover:text-blue-300">Alan Smith</a>') %}
                    {% endif %}
                    <p class="mb-3">{{ p|safe }}</p>
                  {% endfor %}
                </div>
                <div class="mb-4">
                  {% set sources = slide.sources1 %}
                  {% include 'components/common/sources.html' %}
                </div>
              {% else %}
                <p class="text-white leading-relaxed">{{ slide.text }}</p>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
  
  <!-- Navigation arrows with Tailwind -->
  <button class="carousel-control-prev" type="button" data-bs-target="#{{ carousel_id }}" data-bs-slide="prev">
    <span class="carousel-control-prev-icon bg-black/50 rounded-full p-2 hover:bg-black/70 transition-all" aria-hidden="true"></span>
    <span class="visually-hidden">Previous</span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#{{ carousel_id }}" data-bs-slide="next">
    <span class="carousel-control-next-icon bg-black/50 rounded-full p-2 hover:bg-black/70 transition-all" aria-hidden="true"></span>
    <span class="visually-hidden">Next</span>
  </button>
</div>


<style>
  /* Responsive fixed height for carousel */
  @media (min-width: 768px) {
    .carousel-fixed-size {
      min-height: 400px;
      height: auto;
      max-height: 80vh;
    }
    .carousel-fixed-size .carousel-inner,
    .carousel-fixed-size .carousel-item,
    .carousel-fixed-size .row,
    .carousel-fixed-size .col-md-6 {
      min-height: 400px;
      height: 100%;
      max-height: 80vh;
    }
  }
  @media (max-width: 767.98px) {
    .carousel-fixed-size {
      min-height: 200px;
      height: auto;
      max-height: 60vh;
    }
  }

  /* Specific styling for achievements and irl page images */
  #achievementsCarousel img,
  #irlCarousel img {
    max-width: 100%;
    max-height: 100%;
    width: auto;
    height: auto;
    object-fit: contain;
  }

  /* Ensure side-by-side layout for achievements and irl carousels */
  #achievementsCarousel .carousel-item > div,
  #irlCarousel .carousel-item > div {
    display: flex;
    flex-direction: row;
    width: 100%;
    height: 100%;
  }

  #achievementsCarousel .carousel-item > div > div,
  #irlCarousel .carousel-item > div > div {
    flex: 1;
    min-width: 0;
  }

  /* Center images in their containers */
  #achievementsCarousel .carousel-item > div > div:first-child,
  #irlCarousel .carousel-item > div > div:first-child {
    display: flex;
    align-items: center;
    justify-content: center;
  }
</style>
